<!DOCTYPE html>
<html lang="de">

<head>
    <!-- ./sites/protocol.html -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blower-Door Pr√ºfverfahren gem. ISO 9972:2018</title>

    <!-- LINK externe stylesheet Anbindung -->
    <link rel="stylesheet" href="./protocol_style/scope_style.css">

    <!-- LINK Transfer-System -->
    <script src="../js/transfer.js"></script>

    <!-- LINK F√úGEN SIE CHART.JS HINZU (falls noch nicht vorhanden) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.js"></script>

</head>

<body>
    <!-- ANCHOR Seite 1 -->
    <div class="page">
        <div class="hole-second"></div>
        <div class="hole-third"></div>
        <div class="header">
            <div class="header-background"></div>
            <div class="logo-placeholder">LOGO</div>
            <div class="title">
                <h1>Blower-Door</h1>
                <p>Pr√ºfverfahren gem. ISO 9972:2018</p>
            </div>
            <div class="map-placeholder">Karte</div>
        </div>

        <div class="info-block" style="margin-bottom: 20px;">
            <h3>Gepr√ºftes Objekt:</h3>
            <div class="field-group">
                <label>Objekt:</label>
                <input type="text" value="Wohneinheit nach Sanierung">
            </div>
            <div class="field-group">
                <label>Bauabschnitt:</label>
                <input type="text" value="EG">
            </div>
            <div class="field-group">
                <label>Adresse:</label>
                <input type="text" value="Ernst-Th√§lmann-Stra√üe 27">
            </div>
            <div class="field-group">
                <label>PLZ/Ort:</label>
                <input type="text" value="D-99423 Weimar">
            </div>
        </div>

        <div class="info-block" style="margin-bottom: 20px;">
            <h3>Auftraggeber/in:</h3>
            <div class="field-group">
                <label>Name:</label>
                <input type="text" value="Sarah B√§umel">
            </div>
            <div class="field-group">
                <label>Adresse:</label>
                <input type="text" value="Ernst-Th√§lmann-Stra√üe 27">
            </div>
            <div class="field-group">
                <label>PLZ/Ort:</label>
                <input type="text" value="D-99423 Weimar">
            </div>
        </div>

        <div class="info-block" style="margin-bottom: 20px;">
            <h3>Auftragnehmer:</h3>
            <div class="field-group">
                <label>Name:</label>
                <input type="text" value="Dipl.-Ing. Christoph Quiatkowski">
            </div>
            <div class="field-group">
                <label>Beruf:</label>
                <input type="text" value="Architekturdienstleister und Energieberater">
            </div>
            <div class="field-group">
                <label>Adresse:</label>
                <input type="text" value="Kegelplatz 5, D-99423 Weimar">
            </div>
            <div class="field-group">
                <label>E-Mail:</label>
                <input type="email" value="christoph@immergo.de">
            </div>
            <div class="field-group">
                <label>Tel.:</label>
                <input type="tel" value="0162-9182524">
            </div>
        </div>

        <div class="info-block" style="margin-bottom: 20px;">
            <h3>Messungen durchgef√ºhrt von:</h3>
            <div class="field-group">
                <label>Name:</label>
                <input type="text" value="Techniker(FH) Danny Heinicke">
            </div>
            <div class="field-group">
                <label>Qualifikation:</label>
                <input type="text" value="Staatlich gepr. K√§lte- und Klimasystemtechniker">
            </div>
        </div>

        <div class="footer">
            <div class="footer-logo">FLIB</div>
            <div>
                <div>Pr√ºfergebnis:</div>
                <div>gemessen am: </div>
            </div>
            <div>
                <div><strong>Bestanden</strong></div>
                <div><strong>November 2025</strong></div>
            </div>
            <div style="font-size: 14px;">Seite 1 von 6</div>
        </div>
    </div>

    <!-- ANCHOR Seite 2 -->
    <div class="page">
        <div class="hole-second"></div>
        <div class="hole-third"></div>
        <div class="header">
            <div class="header-background"></div>
            <div class="logo-placeholder">LOGO</div>
            <div class="title">
                <h1>Blower-Door</h1>
                <p>Pr√ºfverfahren gem. ISO 9972:2018</p>
            </div>
            <div class="map-placeholder">Karte</div>
        </div>

        <div class="section">
            <div class="section-title">Zweck der Messung:</div>
            <div class="info-block" style="margin-bottom: 20px;">
                <h3>√úberpr√ºfung der Anforderung nach KfW-Richtlinie</h3>
            </div>
        </div>

        <div class="section">
            <div class="section-title">Anwendungen:</div>
            <div class="interactive-text-area">
                <h4>üìù Anwendungen</h4>
                <textarea class="editable-text" id="applications-text" placeholder="spezifische Anwendungen 

Beispiele:
‚Ä¢ Leckageortung vor Fertigstellung
‚Ä¢ Qualit√§tskontrolle der Bauausf√ºhrung
‚Ä¢ Nachweis f√ºr F√∂rderungen (KfW, BAFA)
‚Ä¢ √úberpr√ºfung nach Sanierungsma√ünahmen
‚Ä¢ Dokumentation f√ºr Energieausweis"></textarea>
                <div class="text-hint"></div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">Definition:</div>
            <div class="info-block" style="margin-bottom: 20px;">
                <p>Die Blower-Door Messung ist ein Verfahren gem ISO 9972:2018 zur Bestimmung der Luftdurchl√§ssigkeit
                    von Geb√§uden. Diese werden zur Qualit√§tskontrolle der Bauausf√ºhrung und zur √úberpr√ºfung der
                    Anforderungen nach KfW-Richtlinien eingesetzt.</p>
            </div>
        </div>

        <div class="footer">
            <div class="footer-logo">FLIB</div>
            <div>
                <div>Pr√ºfergebnis:</div>
                <div>gemessen am: </div>
            </div>
            <div>
                <div><strong>Bestanden</strong></div>
                <div><strong>November 2025</strong></div>
            </div>
            <div style="font-size: 14px;">Seite 2 von 6</div>
        </div>
    </div>

    <!-- ANCHOR Seite 3 - HIER SIND DIE √úBERTRAGENEN DATEN -->
    <div class="page">
        <div class="hole-second"></div>
        <div class="hole-third"></div>
        <div class="header">
            <div class="header-background"></div>
            <div class="logo-placeholder">LOGO</div>
            <div class="title">
                <h1>Blower-Door</h1>
                <p>Pr√ºfverfahren gem. ISO 9972:2018</p>
            </div>
            <div class="map-placeholder">Karte</div>
        </div>

        <div class="info-block" style="margin-bottom: 20px;">
            <h3>Geb√§udedaten:</h3>
            <div class="field-group">
                <label>Netto-Raumvolumen V:</label>
                <input type="number" placeholder="volume" data-transfer="volume"> m¬≥
            </div>
            <div class="field-group">
                <label>H√ºllfl√§che:</label>
                <input type="number" placeholder="h√ºllfl√§che"> m¬≤
            </div>
            <div class="field-group">
                <label>Geschossanzahl:</label>
                <input type="number" placeholder="geschossanzahl">
            </div>
            <div class="field-group">
                <label>Nutzungsart:</label>
                <input type="text" placeholder="nutzungsart">
            </div>
        </div>

        <div class="info-block" style="margin-bottom: 20px;">
            <h3>Wetterdaten:</h3>
            <div class="field-group">
                <label>Au√üentemp.:</label>
                <input type="number" placeholder="outside-temp" data-transfer="outside-temp"> ¬∞C
            </div>
            <div class="field-group">
                <label>Innentemp.:</label>
                <input type="number" placeholder="inside-temp" data-transfer="inside-temp"> ¬∞C
            </div>
            <div class="field-group">
                <label>Wind:</label>
                <input type="number" placeholder="wind-speed" data-transfer="wind-speed"> m/s
            </div>
            <div class="field-group">
                <label>Windrichtung:</label>
                <input type="text" placeholder="wind-direction" data-transfer="wind-direction">
            </div>
            <div class="field-group">
                <label>Luftdruck:</label>
                <input type="number" placeholder="air-pressure" data-transfer="air-pressure"> hPa
            </div>
            <div class="field-group">
                <label>Luftfeuchtigkeit:</label>
                <input type="number" placeholder="humidity" data-transfer="humidity"> %
            </div>
        </div>

        <div class="info-block">
            <h3>Messger√§t:</h3>
            <div class="field-group">
                <label>Hersteller:</label>
                <input type="text" value="Testo">
            </div>
            <div class="field-group">
                <label>Typ/Modell:</label>
                <input type="text" value="DP-510i">
            </div>
            <div class="field-group">
                <label>Seriennummer:</label>
                <input type="text" value="46884224">
            </div>
            <div class="field-group">
                <label>Kalibrierung g√ºltig bis:</label>
                <input type="text" value="03/27">
            </div>
        </div>

        <div class="footer">
            <div class="footer-logo">FLIB</div>
            <div>
                <div>Pr√ºfergebnis:</div>
                <div>gemessen am: </div>
            </div>
            <div>
                <div><strong>Bestanden</strong></div>
                <div><strong>November 2025</strong></div>
            </div>
            <div style="font-size: 14px;">Seite 3 von 6</div>
        </div>
    </div>

    <!-- ANCHOR Seite 4 -->
    <div class="page">
        <div class="hole-second"></div>
        <div class="hole-third"></div>
        <div class="header">
            <div class="header-background"></div>
            <div class="logo-placeholder">LOGO</div>
            <div class="title">
                <h1>Blower-Door</h1>
                <p>Pr√ºfverfahren gem. ISO 9972:2018</p>
            </div>
            <div class="map-placeholder">Karte</div>
        </div>

        <div class="section-title">Messwerte:</div>

        <div class="info-block" style="margin-bottom: 20px;">
            <h3>Unterdruckmessungen:</h3>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Messung Nr.</th>
                        <th>Differenzdruck [Pa]</th>
                        <th>Volumenstrom [m¬≥/h]</th>
                        <th>Bemerkungen</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>-10</td>
                        <td>850</td>
                        <td>Startwert</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>-20</td>
                        <td>1200</td>
                        <td>Stabil</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>-30</td>
                        <td>1480</td>
                        <td>Optimal</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>-40</td>
                        <td>1720</td>
                        <td>Gut</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>-50</td>
                        <td>1950</td>
                        <td>Referenzwert</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="info-block" style="margin-bottom: 20px;">
            <h3>√úberdruckmessungen:</h3>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Messung Nr.</th>
                        <th>Differenzdruck [Pa]</th>
                        <th>Volumenstrom [m¬≥/h]</th>
                        <th>Bemerkungen</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>10</td>
                        <td>820</td>
                        <td>Startwert</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>20</td>
                        <td>1150</td>
                        <td>Stabil</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>30</td>
                        <td>1420</td>
                        <td>Optimal</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>40</td>
                        <td>1680</td>
                        <td>Gut</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>50</td>
                        <td>1920</td>
                        <td>Referenzwert</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="footer">
            <div class="footer-logo">FLIB</div>
            <div>
                <div>Pr√ºfergebnis:</div>
                <div>gemessen am: </div>
            </div>
            <div>
                <div><strong>Bestanden</strong></div>
                <div><strong>November 2025</strong></div>
            </div>
            <div style="font-size: 14px;">Seite 4 von 6</div>
        </div>
    </div>

    <!-- ANCHOR Seite 5 -->
    <div class="page">
        <div class="hole-second"></div>
        <div class="hole-third"></div>
        <div class="header">
            <div class="header-background"></div>
            <div class="logo-placeholder">LOGO</div>
            <div class="title">
                <h1>Blower-Door</h1>
                <p>Pr√ºfverfahren gem. ISO 9972:2018</p>
            </div>
            <div class="map-placeholder">Karte</div>
        </div>


        <div class="section-title">Diagramm:</div>

        <!-- CHART CONTAINER - WICHTIG F√úR DIAGRAMM -->
        <div class="chart-placeholder" id="chart-container"
            style="width: 100%; height: 500px; background: #f8fafc; border-radius: 12px; padding: 20px; margin: 20px 0; border: 2px dashed #cbd5e1;">
            <div class="text-center mb-6">
                <h2 class="text-2xl font-bold text-slate-200 mb-2">üìà Blower-Door Messung</h2>
                <p class="text-slate-400">Druckverlauf-Diagramm nach ISO 9972:2018</p>
            </div>

            <!-- Chart Area -->
            <div id="chart-area" class="bg-slate-800/50 rounded-xl p-6 mb-6" style="min-height: 500px;">
                <div class="flex items-center justify-center h-96 text-slate-500">
                    <div class="text-center">
                        <div class="text-6xl mb-4"></div>
                        <div class="text-lg font-medium"></div>
                        <div class="text-sm opacity-70"></div>
                    </div>
                </div>
            </div>

            <!-- Chart Controls -->
            <div id="chart-controls" class="grid grid-cols-1 md:grid-cols-5 gap-4">
                <div class="data-card rounded-lg p-4 text-center">
                    <div class="text-xs text-slate-400 mb-1"></div>
                    <div id="chart-status-value" class="text-lg font-bold text-amber-400"></div>
                </div>
                <div class="data-card rounded-lg p-4 text-center">
                    <div class="text-xs text-slate-400 mb-1"></div>
                    <div id="underpressure-count" class="text-lg font-bold text-red-400"></div>
                </div>
                <div class="data-card rounded-lg p-4 text-center">
                    <div class="text-xs text-slate-400 mb-1"></div>
                    <div id="overpressure-count" class="text-lg font-bold text-green-400"></div>
                </div>
                <div class="data-card rounded-lg p-4 text-center">
                    <div class="text-xs text-slate-400 mb-1"></div>
                    <div id="total-points" class="text-lg font-bold text-blue-400"></div>
                </div>
                <div class="data-card rounded-lg p-4 text-center">
                    <div class="text-xs text-slate-400 mb-1"></div>
                    <div id="n50-display" class="text-lg font-bold text-rose-400"></div>
                </div>
            </div>
        </div>


        <div class="measurement-controls">
            <div class="control-card">
                <h4>n‚ÇÖ‚ÇÄ-Wert [1/h]</h4>
                <div class="control-value" data-transfer="n50">1.5</div>
            </div>
            <div class="control-card">
                <h4>Geb√§udevolumen [m¬≥]</h4>
                <div class="control-value" data-transfer="volume">100</div>
            </div>
            <div class="control-card">
                <h4>Max. Druck [Pa]</h4>
                <div class="control-value" data-transfer="pressure">200</div>
            </div>
        </div>

        <div class="measurement-controls">

            <div class="control-card">


                <button onclick="testVisualChart()"
                    class="bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white px-6 py-3 rounded-lg font-medium transition-all duration-300 shadow-lg">
                    üß™ Test-Diagramm erstellen
                </button>

                <button onclick="clearChart()"
                    class="bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-500 hover:to-slate-600 text-white px-6 py-3 rounded-lg font-medium transition-all duration-300 shadow-lg">
                    üóëÔ∏è Diagramm leeren
                </button>

                <button onclick="exportChart()"
                    class="bg-gradient-to-r from-emerald-600 to-green-600 hover:from-emerald-500 hover:to-green-500 text-white px-6 py-3 rounded-lg font-medium transition-all duration-300 shadow-lg">
                    üíæ Als Bild speichern
                </button>
            </div>
        </div>
    </div>

    </div>




    <!-- ANCHOR Seite 6 -->
    <div class="page">
        <div class="hole-second"></div>
        <div class="hole-third"></div>
        <div class="header">
            <div class="header-background"></div>
            <div class="logo-placeholder">LOGO</div>
            <div class="title">
                <h1>Blower-Door</h1>
                <p>Pr√ºfverfahren gem. ISO 9972:2018</p>
            </div>
            <div class="map-placeholder">Karte</div>
        </div>

        <div class="section-title">Auswertung:</div>

        <div class="definitions-grid">
            <div class="definition-card definition-blue">
                <h4>üîµ Grundlegende Definitionen</h4>
                <p><strong>n‚ÇÖ‚ÇÄ-Wert:</strong> Luftwechselrate bei 50 Pa Druckdifferenz</p>
                <p><strong>q‚ÇÖ‚ÇÄ-Wert:</strong> Spezifischer Leckagestrom pro m¬≤ H√ºllfl√§che</p>
                <p><strong>V‚ÇÖ‚ÇÄ:</strong> Volumenstrom bei 50 Pa Druckdifferenz</p>
            </div>

            <div class="definition-card definition-green">
                <h4>üü¢ Technische Parameter</h4>
                <p><strong>Potenzfunktion:</strong> V = C √ó ŒîP^n</p>
                <p><strong>Typischer n-Wert:</strong> 0,65 (f√ºr turbulente Str√∂mung)</p>
                <p><strong>Messbereich:</strong> 10-100 Pa (nach ISO 9972)</p>
            </div>
        </div>

        <div class="interactive-text-area">
            <h4>üìù Detaillierte Bewertung der Messergebnisse</h4>
            <textarea class="editable-text evaluation-text" id="evaluation-text" placeholder="Hier k√∂nnen Sie eine detaillierte Bewertung der Messergebnisse eintragen...

Beispielhafte Bewertungskriterien:
‚Ä¢ Bewertung der gemessenen n‚ÇÖ‚ÇÄ-Werte im Vergleich zu Grenzwerten
‚Ä¢ Einhaltung der KfW-Anforderungen (n‚ÇÖ‚ÇÄ ‚â§ 1,5 h‚Åª¬π)
‚Ä¢ Qualit√§t der Messung (Korrelationskoeffizient R¬≤)
‚Ä¢ Identifizierte Leckagen und deren Bedeutung
‚Ä¢ Empfehlungen f√ºr Nachbesserungen
‚Ä¢ Fazit zur Luftdichtheit des Geb√§udes

Bewertung der Messergebnisse:
Der gemessene n‚ÇÖ‚ÇÄ-Wert von 1,5 h‚Åª¬π entspricht exakt dem KfW-Grenzwert f√ºr Sanierungen. Die Messung zeigt eine gute Korrelation zwischen Unter- und √úberdruckmessungen.

Empfehlungen:
- Alle gr√∂√üeren Leckagen wurden bereits w√§hrend der Messung identifiziert und sollten abgedichtet werden
- Nachkontrolle in 6 Monaten empfohlen"></textarea>
            <div class="text-hint">Tipp: Bewerten Sie hier die Messergebnisse fachlich und geben Sie konkrete
                Empfehlungen</div>
        </div>

        <div class="signature-boxes">
            <div class="signature-box">
                <div><strong>Techniker(FH) D.Heinicke</strong></div>
                <div style="margin-top: 70px;">
                    <div style="font-size: 12px;">
                        <p>...............................................................</p> Datum,
                        Unterschrift
                        Messtechniker
                    </div>
                </div>
            </div>

            <div class="signature-box">
                <div><strong>Dipl.-Ing C. Quiatkowski</strong></div>
                <div style="margin-top: 70px;">
                    <div style="font-size: 12px;">
                        <p>...............................................................</p>Datum,
                        Unterschrift
                        Auftraggeber
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <div class="footer-logo">FLIB</div>
            <div>
                <div>Pr√ºfergebnis:</div>
                <div>gemessen am: </div>
            </div>
            <div>
                <div><strong>Bestanden</strong></div>
                <div><strong>November 2025</strong></div>
            </div>
            <div style="font-size: 14px;">Seite 6 von 6</div>
        </div>
    </div>



    <!-- JavaScript f√ºr Chart-Seite -->
    <script>
        // Chart-Seite spezifische Funktionen

        // Aktualisiere Status-Anzeige
        function updateChartStatus(status, color = 'amber') {
            const statusElement = document.getElementById('chart-status-value');
            if (statusElement) {
                statusElement.textContent = status;
                statusElement.className = `text-lg font-bold text-${color}-400`;
            }
        }

        // Aktualisiere Daten-Zusammenfassung
        function updateDataSummary(measurements) {
            if (!measurements) return;

            // Z√§hler aktualisieren
            document.getElementById('underpressure-count').textContent = measurements.underpressure?.length || 0;
            document.getElementById('overpressure-count').textContent = measurements.overpressure?.length || 0;
            document.getElementById('total-points').textContent =
                (measurements.underpressure?.length || 0) + (measurements.overpressure?.length || 0);

            // Unterdruck-Details
            if (measurements.underpressure?.length > 0) {
                const pressures = measurements.underpressure.map(p => Math.abs(p.pressure));
                const volumes = measurements.underpressure.map(p => p.volume);
                document.getElementById('underpressure-range').textContent =
                    `${Math.min(...pressures)}-${Math.max(...pressures)} Pa`;
                document.getElementById('underpressure-data').textContent =
                    `Volumenstrom: ${Math.min(...volumes)}-${Math.max(...volumes)} m¬≥/h`;
            }

            // √úberdruck-Details
            if (measurements.overpressure?.length > 0) {
                const pressures = measurements.overpressure.map(p => p.pressure);
                const volumes = measurements.overpressure.map(p => p.volume);
                document.getElementById('overpressure-range').textContent =
                    `${Math.min(...pressures)}-${Math.max(...pressures)} Pa`;
                document.getElementById('overpressure-data').textContent =
                    `Volumenstrom: ${Math.min(...volumes)}-${Math.max(...volumes)} m¬≥/h`;
            }
        }

        // Aktualisiere Parameter-Anzeige
        function updateParameters(chartData) {
            if (!chartData) return;

            document.getElementById('volume-param').textContent =
                chartData.parameters?.volume ? `${chartData.parameters.volume} m¬≥` : '-';
            document.getElementById('n50-param').textContent =
                chartData.parameters?.n50 ? `${chartData.parameters.n50} 1/h` : '-';
            document.getElementById('n50-display').textContent =
                chartData.parameters?.n50 || 'N/A';
            document.getElementById('pressure-param').textContent =
                chartData.parameters?.pressure ? `${chartData.parameters.pressure} Pa` : '-';

            // Berechne Ergebnisse
            if (chartData.parameters?.n50 && chartData.parameters?.volume) {
                const n50 = parseFloat(chartData.parameters.n50);
                const volume = parseFloat(chartData.parameters.volume);

                const q50 = (n50 * 2.68).toFixed(2);
                const v50 = (n50 * volume).toFixed(0);
                const evaluation = n50 <= 1.5 ? 'Bestanden' : 'Nicht bestanden';

                document.getElementById('q50-result').textContent = `${q50} m¬≥/(h¬∑m¬≤)`;
                document.getElementById('v50-result').textContent = `${v50} m¬≥/h`;
                document.getElementById('evaluation').textContent = evaluation;
                document.getElementById('evaluation').className =
                    `text-${n50 <= 1.5 ? 'green' : 'red'}-400`;
            }
        }

        // Leere Chart
        function clearChart() {
            const chartArea = document.getElementById('chart-area');
            if (chartArea) {
                chartArea.innerHTML = `
                    <div class="flex items-center justify-center h-96 text-slate-500">
                        <div class="text-center">
                            <div class="text-6xl mb-4">üìà</div>
                            <div class="text-lg font-medium">Diagramm-Bereich</div>
                            <div class="text-sm opacity-70">Wird automatisch beim Datenempfang erstellt</div>
                        </div>
                    </div>
                `;
            }
            updateChartStatus('Geleert', 'slate');
        }

        // Exportiere Chart als Bild
        function exportChart() {
            const canvas = document.querySelector('#chart-area canvas');
            if (canvas) {
                const link = document.createElement('a');
                link.download = `blower-door-diagramm-${new Date().toISOString().split('T')[0]}.png`;
                link.href = canvas.toDataURL();
                link.click();
                updateChartStatus('Exportiert', 'green');
            } else {
                alert('Kein Diagramm zum Exportieren verf√ºgbar!');
            }
        }

        // √úberschreibe Transfer-Funktion f√ºr Chart-Seite
        if (typeof enhanceWithVisualChart === 'function') {
            // Erweitere f√ºr Chart-Seite
            setTimeout(() => {
                if (window.completeTransferSystem) {
                    const originalUpdateChart = window.completeTransferSystem.updateChartDisplay;

                    window.completeTransferSystem.updateChartDisplay = function (chartData) {
                        console.log("üé® Chart-Seite: Aktualisiere Diagramm...");

                        const transferData = JSON.parse(sessionStorage.getItem('blowerDoorTransfer') || '{}');
                        const measurements = transferData.measurements || { underpressure: [], overpressure: [], combined: [] };

                        // Aktualisiere UI
                        updateChartStatus('Erstelle...', 'blue');
                        updateDataSummary(measurements);
                        updateParameters(chartData);

                        // Verstecke Status-Banner
                        const statusBanner = document.getElementById('chart-status');
                        if (statusBanner) {
                            statusBanner.style.display = 'none';
                        }

                        // Erstelle Diagramm im chart-area
                        const chartArea = document.getElementById('chart-area');
                        if (chartArea) {
                            chartArea.innerHTML = '';

                            // Verwende die bestehende Visual Chart Funktion
                            setTimeout(() => {
                                if (typeof transferVisualChart === 'function') {
                                    transferVisualChart(chartData, measurements);
                                    updateChartStatus('Aktiv', 'green');

                                    // Transfer-Info aktualisieren
                                    document.getElementById('transfer-time').textContent =
                                        'Letzte √úbertragung: ' + new Date().toLocaleString('de-DE');
                                    document.getElementById('transfer-source').textContent =
                                        'Quelle: ' + (transferData.transferType || 'Unbekannt');
                                }
                            }, 100);
                        }
                    };
                }
            }, 1000);
        }

        // Auto-load beim Seitenaufruf
        document.addEventListener('DOMContentLoaded', () => {
            console.log("üìä Chart-Seite geladen");

            // Pr√ºfe auf √ºbertragene Daten
            const transferData = sessionStorage.getItem('blowerDoorTransfer');
            if (transferData) {
                try {
                    const data = JSON.parse(transferData);
                    console.log("üì• Gefundene √úbertragungsdaten, lade automatisch...");

                    if (window.completeTransferSystem && data.chart) {
                        window.completeTransferSystem.updateChartDisplay(data.chart);
                    }
                } catch (error) {
                    console.error("‚ùå Fehler beim Laden der √úbertragungsdaten:", error);
                }
            }
        });
    </script>
</body>

</html>